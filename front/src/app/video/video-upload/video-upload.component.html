<div class="container">
  <h2>Upload New Video</h2>
  <form (ngSubmit)="onSubmit()" #uploadForm="ngForm">
    <div class="form-group">
      <label for="title">Title</label>
      <input type="text" id="title" name="title" [(ngModel)]="title" required>
    </div>
    <div class="form-group">
      <label for="description">Description</label>
      <textarea id="description" name="description" [(ngModel)]="description" required></textarea>
    </div>
    <div class="form-group">
      <label for="tags">Tags (comma-separated)</label>
      <input type="text" id="tags" name="tags" [(ngModel)]="tags">
    </div>
    <div class="form-group">
      <label>Location (coordinates)</label>
      <div class="coords-row">
        <input type="text" [value]="latitude !== null ? latitude : ''" placeholder="Latitude" readonly>
        <input type="text" [value]="longitude !== null ? longitude : ''" placeholder="Longitude" readonly>
      </div>
      <div class="coords-actions">
        <button type="button" class="map-btn" (click)="openMap()">Select on map</button>
        <button type="button" class="clear-btn" (click)="clearLocation()" [disabled]="latitude === null || longitude === null">Clear</button>
      </div>
    </div>
    <div class="form-group">
      <label for="thumbnail">Thumbnail Image</label>
      <input type="file" id="thumbnail" (change)="onThumbnailSelected($event)" accept="image/*" required>
    </div>
    <div class="form-group">
      <label for="video">Video File (MP4, max 200MB)</label>
      <input type="file" id="video" (change)="onVideoSelected($event)" accept="video/mp4" required>
    </div>
    
    <button type="submit" [disabled]="!uploadForm.form.valid || !selectedThumbnail || !selectedVideo || latitude === null || longitude === null" class="upload-btn">
      Upload Video
    </button>

    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>
     <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>
  </form>
</div>

<div class="map-modal" *ngIf="showMap">
  <div class="map-dialog">
    <div class="map-header">
      <h3>Select location</h3>
      <button type="button" class="close-btn" (click)="closeMap()">Ã—</button>
    </div>
    <p class="map-hint">Click on the map to drop a marker and save coordinates.</p>
    <div id="upload-map" class="map-canvas"></div>
    <div class="map-footer">
      <div class="coords-preview" *ngIf="latitude !== null && longitude !== null">
        {{ latitude }}, {{ longitude }}
      </div>
      <div class="map-actions">
        <button type="button" class="secondary-btn" (click)="closeMap()">Cancel</button>
        <button type="button" class="primary-btn" (click)="confirmLocation()">Confirm</button>
      </div>
    </div>
  </div>
</div>
